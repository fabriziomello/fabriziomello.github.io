---
layout: post
title: "Instalar/Configurar \"Debugador\" de PL/pgSQL (pldebugger) no PostgreSQL 9.1 usando Ubuntu"
date: 2012-05-17
comments: false
---

<div class='post'>
<br />O passo-a-passo abaixo foi realizado no Ubuntu 10.04LTS com o PostgreSQL 9.1 instalado via ppa do Martin Pitti, mas creio que pode ser executado tranquilamente utilizando a última versão LTS do Ubuntu, a 12.04LTS.<br /><br />1) Download dos fontes do PostgreSQL<br /><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ wget -c http://ftp.postgresql.org/pub/source/v9.1.3/postgresql-9.1.3.tar.bz2</span><br /><br /><br />2) Precisamos instalar ferramentas necessárias para compilação da extensão<br /><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ sudo apt-get update</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ sudo apt-get install build-essential libreadline-dev zlib1g-dev flex bison libssl-dev git-core</span><br /><br /><br />3) Compilar o PostgreSQL e a extensao pldebugger<br /><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ tar jxvf postgresql-9.1.3.tar.bz2</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ cd postgresql-9.1.3</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ ./configure --prefix=/usr --includedir=/usr/include --mandir=/usr/share/man --infodir=/usr/share/info --sysconfdir=/etc --localstatedir=/var --libexecdir=/usr/lib/postgresql-9.1 --srcdir=. --mandir=/usr/share/postgresql/9.1/man --docdir=/usr/share/doc/postgresql-doc-9.1 --datadir=/usr/share/postgresql/9.1 --bindir=/usr/lib/postgresql/9.1/bin --libdir=/usr/lib/postgresql/9.1/lib --includedir=/usr/include/postgresql/ --enable-integer-datetimes --with-openssl</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ make</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ cd contrib</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ git clone git://git.postgresql.org/git/pldebugger.git</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ cd pldebugger</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ make</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ sudo make install</span><br /><br />Obs: lembrando que, apesar de extenso, o "./configure" deve ser todo escrito na mesma linha<br /><br />4) Após compilar e instalar a extensao pldebugger precisamos ativa-a no PostgreSQL<br /><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ sudo vim /etc/postgresql/9.1/main/postgresql.conf</span><br /><br />alterar<br />&nbsp;<br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">&nbsp; #shared_preload_libraries = ''</span><br /><br />para<br />&nbsp;<br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">&nbsp; shared_preload_libraries = '$libdir/plugin_debugger'</span><br />&nbsp;<br /><br />5) Reiniciar PostgreSQL<br /><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ sudo /etc/init.d/postgresql restart 9.1</span><br /><br /><br />6) Criar a EXTENSAO "pldbgpapi" na(s) base(s) de dados que deseja fazer debug de pls<br /><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">$ psql -U postgres bdteste</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">psql (9.1.3)</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">Digite "help" para ajuda.</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;"><br /></span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">bdteste=# CREATE EXTENSION pldbgapi;</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">CREATE EXTENSION</span><br /><span style="font-family: 'Courier New', Courier, monospace; font-size: x-small;">bdteste=#</span><br /><br /><br />7) Pronto, agora vc pode usar o PGAdmin para "debugar" suas funções PL/pgSQL<br /><br /><br /><br />---<br />Fabrízio Mello<br />fabriziomello [at] gmail.com<br /><div><br /></div><br /></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Fabrízio de Royes Mello</div>
<div class='content'>
Olá Fábio,<br /><br />Minha experiência com PostgreSQL nessa plataforma (Windows) é limitada, mas parece que nesse seu caso o problema é no seu &quot;pg_hba.conf&quot; (Host Based Authentication), ou seja, o arquivo de configuração das permissões para autenticação dos usuários na base de dados. Tente editá-lo e alterar os métodos de autenticação das regras (última coluna) para &quot;trust&quot;, depois faça um reload no processo do PostgreSQL e tente novamente.<br /><br />Também gostaria de comentar que esse não é o melhor local para vc tirar esse tipo de dúvida, então o convido para assinar nossa lista de discussão [1] da Comunidade Brasileira de PostgreSQL, onde temos muitas pessoas observando as dúvidas e ajudando. Faça um teste, se cadastre lá e envie um email com essa dúvida e vc verá como será.<br /><br />Abraços,<br /><br />[1] https://listas.postgresql.org.br/cgi-bin/mailman/listinfo/pgbr-geral<br /><br />--<br />Fabrízio de Royes Mello<br />Comunidade Brasileira de PostgreSQL</div>
</div>
<div class='comment'>
<div class='author'>Fabio</div>
<div class='content'>
Olá Fabrízio !! Estou com um problema no postgresql e estou na minha primeira instalação para começar a aprender...Na hora que estou criando o banco pela linha de comando ele pede senha e eu digito, mas apareçe uma mensagem tipo &quot;postgres não conseguiu conectar com o database erro fatal, falha na autenticação da senha&quot;, no entanto já troquei a senha do usuario postgres diversas vezes e o erro persiste. Estou usando a ferramenta no windows seven 64bits(já tentei no XP tambem)... Poderia me ajudar? Desde já muito obrigado e valeu pela atenção!!!  </div>
</div>
</div>
